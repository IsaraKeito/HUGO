{{ $dbUrl := .Get 0 }}
{{ $apiUrl := "https://neodb.social/api/me/shelf/item/" }}
{{ $itemUuid := "" }}
{{ $authToken := "" }} <!-- 请替换为你的 API Personal Token -->

<!-- 判断是否为生产环境 -->
{{ if eq (hugo.Environment) "production" }}

    <!-- 解析 item_uuid -->
    {{ if (findRE `.*neodb\.social\/.*\/(.*)` $dbUrl) }}
        {{ $itemUuid = replaceRE `.*neodb\.social\/.*\/(.*)` "$1" $dbUrl }}
    {{ else }}
        <p style="text-align: center;"><small>无效的 URL 格式。</small></p>
        {{ return }}
    {{ end }}

    <!-- 构造 API 请求地址 -->
    {{ $dbApiUrl := print $apiUrl $itemUuid }}
    {{ $headers := dict "Authorization" (print "Bearer " $authToken) }}

    <!-- 获取 API 数据 -->
    {{ $dbFetch := getJSON $dbApiUrl $headers }}

    {{ if $dbFetch }}
        {{ $shelfType := $dbFetch.shelf_type }}
        {{ $category := $dbFetch.item.category }}
        {{ $action := "" }}
        {{ $prefix := "" }}
        {{ $suffix := "" }}
        {{ $displayText := "" }}

        <!-- 根据类别决定动作 -->
        {{ if eq $category "book" }}{{ $action = "读" }}
        {{ else if or (eq $category "tv") (eq $category "movie") (eq $category "performance") }}{{ $action = "看" }}
        {{ else if or (eq $category "podcast") (eq $category "album") }}{{ $action = "听" }}
        {{ else if eq $category "game" }}{{ $action = "玩" }}
        {{ end }}

        <!-- 根据状态决定前后缀 -->
        {{ if eq $shelfType "wishlist" }}{{ $prefix = "想" }}
        {{ else if eq $shelfType "complete" }}{{ $suffix = "过" }}
        {{ else if eq $shelfType "progress" }}{{ $prefix = "在" }}
        {{ else if eq $shelfType "dropped" }}{{ $prefix = "不" }}{{ $suffix = "了" }}
        {{ end }}

        {{ $displayText = print $prefix $action $suffix }}

        <!-- 唯一 ID -->
        {{ $uniqueId := (print "coverImage-" $itemUuid) }}

        <div class="db-card">
            <div class="db-card-subject">
                <div class="db-card-post">
                    <!-- 图片占位 -->
                    <img src="" alt="Placeholder Image" 
                         style="max-width: 100%; height: auto;" 
                         id="{{ $uniqueId }}">
                </div>
                <div class="db-card-content">
                    <div class="db-card-title">
                        <a href="{{ $dbUrl }}" class="cute" target="_blank" rel="noreferrer">{{ $dbFetch.item.title }}</a>
                    </div>
                    <div class="db-card-comment
